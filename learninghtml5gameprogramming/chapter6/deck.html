<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>chapter6</title>
</head>
<body>
	<script>
		function Deck (numDecks) {
			if (!(this instanceof arguments.callee)) {
				return new arguments.callee(arguments);
			}
			var cards;
			var self = this;
			
			self.init = function () {
				var paper = Raphael($("#gameboard")[0], 800, 600);
				self.cards = new Array(52 * numDecks);
				self.initCards();
			}

			self.initCards = function () {
				var ordinals = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'jack', 'queen', 'king',];
				var suits = ['club', 'spade', 'heart', 'diamond'];
				for (var k = 0; k < numDecks; k++) {
					for (var j = 0; j < suits.length; j++) {
						for (var i = 0; i < ordinals.length; i++) {
							var index = (i + (j*13) + (k*52));
							self.cards[index] = new Card(ordinals[i], suits[j]);
						}
					}
				}
				self.shuffleDecks();
				self.init();
			}

			self.suffleDecks = function () {
				var rand = function (max) {
					return Math.floor(Math.random() * max);
				}
				var swap = function (i, j) {
					var temp = self.cards[j];
					self.cards[j] = self.cards[i];
					self.cards[i] = temp;
				}
				for (var j = 0; j < numDecks; j++) {
					for (var i = (numDecks * 51); i >= 0; i--) {
						var r = rand(i);
						swap(i, r);
					}
				}
			}

			self.flipCard = function (frontShown) {
				if (self.meta['hidden'] == true) {
					return
				self.frontShown = !self.frontShown;
				if (self.frontShown) {
					self.cardBack.animate({opacity: 0.0}, 1000);
					self.cardFront.animate({opacity: 1}, 1000);
					game.selectedCards.add(self);
				}else{
					self.cardBack.animate({opacity: 0.0}, 1000);
					self.cardFront.animate({opacity: 1}, 1000);
					game.selectedCards.remove(self);
				}
				console.log(game.selectedCards);
				}
			}
		}
	</script>
</body>
</html>
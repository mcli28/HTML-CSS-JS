<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Walking 2</title>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<canvas id="canvas" width="400" height="400"></canvas>
	<script src="utils.js"></script>
	<script src="segment.js"></script>
	<script>
		window.onload = function () {
			var canvas = document.getElementById('canvas'),
				context = canvas.getContext('2d'),
				segment0 = new Segment(100, 20),
				segment1 = new Segment(100, 20),
				cycle = 0;

			segment0.x = 200;
			segment0.y = 200;

			segment1.x = segment0.getPin().x;
			segment1.y = segment0.getPin().y;

			function walk (segA, segB, cyc) {
				var offset = Math.PI;
				console.log(offset);
				var angle0 = (Math.sin(cyc) * 45 + 90) * Math.PI / 180,
					angle1 = (Math.sin(cyc + offset) * 45 + 45) * Math.PI / 180;

				segA.rotation = angle0;
				segB.rotation = segA.rotation + angle1;
				segB.x = segA.getPin().x;
				segB.y = segA.getPin().y;
			}

			(function drawFrame () {
				window.requestAnimationFrame(drawFrame, canvas);
				context.clearRect(0, 0, canvas.width, canvas.height);

				cycle += 0.02;
				walk(segment0, segment1, cycle);

				segment0.draw(context);
				segment1.draw(context);
			}());
		}
	</script>
</body>
</html>